<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
	<wicket:extend>
	<div class="vista-pmsite-aptListPage">
		<div class="vista-pmsite-contentWrap">
			<div class="vista-pmsite-content">
				<div class="vista-pmsite-mainWrap">
					<div class="vista-pmsite-sidebarWrap">
						<div class="vista-pmsite-sidebar">
							<div class="secondaryNavig">
								<h3><wicket:i18n>Find An Appartment</wicket:i18n></h3>
								<div class="advancedSearchNarrowWrap">
									<form class="advancedSearchCriteria"
										wicket:id="advancedSearchCriteriaForm">
										<div wicket:id="searchCriteriaInput" />
										<input type="submit" wicket:id="searchSubmit" value="Search" />
									</form>
								</div>
							</div>
						</div>
						<div class="vista-pmsite-main">
							<div class="caption2">
								<h1><wicket:i18n>Found Properties</wicket:i18n></h1>
								<div wicket:id="aptListModeSwitch" id="aptListModeSwitch"/>
							</div>
							<div class="apartmentListingWrap">
								<div wicket:id="aptListPanel" />
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script language="javascript" wicket:id="jsAptDetailsUrl"></script>
	<script language="javascript" wicket:id="jsAptListModeInfo"></script>
	<script language="javascript">
	var loadMapIfVisible, loadMapTimer, loadMapCount=0;
	$(function() {
		loadMapIfVisible = function() {
			loadMapCount++;
			if ($('.listing_mapview:visible').size()) {
				try {
					loadMap();
					clearInterval(loadMapTimer);
					loadMapCount = 0;
					return true;
				} catch (err) { }
				// stop after 10 tries (5 sec)
				if (loadMapCount >= 10) {
					clearInterval(loadMapTimer);
				}
				return false;
			}
		}
		$('#aptListModeSwitch').click(function() {
			var curMode = ClientPref.getPref('aptListMode');
			if (aptListModeInfo == undefined || aptListModeInfo[curMode] == undefined)
				return;
			var
				newMode = aptListModeInfo[curMode].next,
				curInfo = aptListModeInfo[curMode],
				newInfo = aptListModeInfo[newMode];

			$(this)
				.removeClass(curInfo.cls)
				.addClass(newInfo.cls)
				.text(newInfo.text);
			$(curInfo.show).addClass('display_none');
			$(newInfo.show).removeClass('display_none');
			ClientPref.setPref('aptListMode', newMode);
			// load map if needed
			loadMapIfVisible();
		});
		// initial map load
		$(window).load(function() {
			// try for a few times (5sec max) as the map may not have been initialized yet
			if (!loadMapIfVisible()) {
				loadMapTimer = setInterval("loadMapIfVisible()", 500);
			}
		});
	})
	</script>
	</wicket:extend>
</body>
</html>
